[
  {
    "id": 31,
    "question": "Top 20 products by total Internet Sales Amount between 2010 and 2014",
    "gold_sql": "SELECT TOP 20\n    p.ProductKey,\n    p.EnglishProductName,\n    SUM(fis.SalesAmount) AS TotalInternetSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY p.ProductKey, p.EnglishProductName\nORDER BY TotalInternetSalesAmount DESC;",
    "model_sql": "SELECT TOP 20 p.ProductKey, p.EnglishProductName, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.ProductKey, p.EnglishProductName ORDER BY TotalSalesAmount DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": true,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 20,
    "model_row_count": 20,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 32,
    "question": "Internet Sales quantity and amount by Product Category between 2010 and 2014",
    "gold_sql": "SELECT\n    pc.EnglishProductCategoryName,\n    SUM(fis.OrderQuantity) AS TotalOrderQuantity,\n    SUM(fis.SalesAmount) AS TotalSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey\nJOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY pc.EnglishProductCategoryName\nORDER BY TotalSalesAmount DESC;",
    "model_sql": "SELECT pc.EnglishProductCategoryName, SUM(fis.OrderQuantity) AS TotalSalesQuantity, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey JOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey JOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY pc.EnglishProductCategoryName ORDER BY TotalSalesAmount DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": true,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 3,
    "model_row_count": 3,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 33,
    "question": "Internet Sales Amount by Product Category and Subcategory between 2010 and 2014",
    "gold_sql": "SELECT\n    pc.EnglishProductCategoryName,\n    psc.EnglishProductSubcategoryName,\n    SUM(fis.SalesAmount) AS TotalSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey\nJOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY pc.EnglishProductCategoryName, psc.EnglishProductSubcategoryName\nORDER BY pc.EnglishProductCategoryName, TotalSalesAmount DESC;",
    "model_sql": "SELECT d.CalendarYear, pc.EnglishProductCategoryName, psc.EnglishProductSubcategoryName, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey JOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey JOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY d.CalendarYear, pc.EnglishProductCategoryName, psc.EnglishProductSubcategoryName ORDER BY d.CalendarYear, pc.EnglishProductCategoryName, psc.EnglishProductSubcategoryName",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 17,
    "model_row_count": 49,
    "sql_exact_match": false,
    "model_correct": false
  },
  {
    "id": 34,
    "question": "Internet Sales Amount by product and calendar year between 2010 and 2014",
    "gold_sql": "SELECT\n    d.CalendarYear,\n    p.ProductKey,\n    p.EnglishProductName,\n    SUM(fis.SalesAmount) AS TotalSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY d.CalendarYear, p.ProductKey, p.EnglishProductName\nORDER BY d.CalendarYear, TotalSalesAmount DESC;",
    "model_sql": "SELECT p.ProductKey, p.EnglishProductName, d.CalendarYear, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.ProductKey, p.EnglishProductName, d.CalendarYear ORDER BY p.ProductKey, d.CalendarYear",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 288,
    "model_row_count": 288,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 35,
    "question": "Average Internet selling price per product between 2010 and 2014",
    "gold_sql": "SELECT\n    p.ProductKey,\n    p.EnglishProductName,\n    SUM(fis.SalesAmount) / NULLIF(SUM(fis.OrderQuantity), 0) AS AvgSellingPrice\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY p.ProductKey, p.EnglishProductName\nORDER BY AvgSellingPrice DESC;",
    "model_sql": "WITH ProductSales AS ( SELECT fis.ProductKey, AVG(fis.UnitPrice) AS AvgUnitPrice FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY fis.ProductKey ) SELECT p.ProductKey, p.EnglishProductName, ps.AvgUnitPrice FROM ProductSales AS ps JOIN DimProduct AS p ON ps.ProductKey = p.ProductKey ORDER BY ps.AvgUnitPrice DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": true,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 158,
    "model_row_count": 158,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 36,
    "question": "Internet gross margin and gross margin percentage by product between 2010 and 2014",
    "gold_sql": "SELECT\n    p.ProductKey,\n    p.EnglishProductName,\n    SUM(fis.SalesAmount - fis.TotalProductCost) AS TotalGrossMargin,\n    CASE WHEN SUM(fis.SalesAmount) = 0 THEN NULL\n         ELSE SUM(fis.SalesAmount - fis.TotalProductCost) / SUM(fis.SalesAmount)\n    END AS GrossMarginPct\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY p.ProductKey, p.EnglishProductName\nORDER BY TotalGrossMargin DESC;",
    "model_sql": "SELECT p.EnglishProductName, SUM(fis.SalesAmount - fis.TotalProductCost) AS GrossMargin, SUM(fis.SalesAmount) AS TotalSales, (SUM(fis.SalesAmount - fis.TotalProductCost) / SUM(fis.SalesAmount)) * 100 AS GrossMarginPercentage FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.EnglishProductName ORDER BY GrossMargin DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 158,
    "model_row_count": 130,
    "sql_exact_match": false,
    "model_correct": false
  },
  {
    "id": 37,
    "question": "Reseller Sales Amount by Product Category between 2010 and 2013",
    "gold_sql": "SELECT\n    pc.EnglishProductCategoryName,\n    SUM(frs.SalesAmount) AS TotalSalesAmount\nFROM FactResellerSales AS frs\nJOIN DimProduct AS p ON frs.ProductKey = p.ProductKey\nJOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey\nJOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey\nJOIN DimDate AS d ON frs.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2013\nGROUP BY pc.EnglishProductCategoryName\nORDER BY TotalSalesAmount DESC;",
    "model_sql": "SELECT pc.EnglishProductCategoryName, d.CalendarYear, SUM(frs.SalesAmount) AS TotalSalesAmount FROM FactResellerSales AS frs JOIN DimDate AS d ON frs.OrderDateKey = d.DateKey JOIN DimProduct AS p ON frs.ProductKey = p.ProductKey JOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey JOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey WHERE d.CalendarYear BETWEEN 2010 AND 2013 GROUP BY pc.EnglishProductCategoryName, d.CalendarYear ORDER BY pc.EnglishProductCategoryName, d.CalendarYear",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 4,
    "model_row_count": 16,
    "sql_exact_match": false,
    "model_correct": false
  },
  {
    "id": 38,
    "question": "Compare Internet and Reseller Sales Amount by Product Category between 2010 and 2013",
    "gold_sql": "WITH InternetSales AS (\n    SELECT\n        pc.EnglishProductCategoryName,\n        SUM(fis.SalesAmount) AS InternetSalesAmount\n    FROM FactInternetSales AS fis\n    JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\n    JOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey\n    JOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey\n    JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\n    WHERE d.CalendarYear BETWEEN 2010 AND 2013\n    GROUP BY pc.EnglishProductCategoryName\n), ResellerSales AS (\n    SELECT\n        pc.EnglishProductCategoryName,\n        SUM(frs.SalesAmount) AS ResellerSalesAmount\n    FROM FactResellerSales AS frs\n    JOIN DimProduct AS p ON frs.ProductKey = p.ProductKey\n    JOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey\n    JOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey\n    JOIN DimDate AS d ON frs.OrderDateKey = d.DateKey\n    WHERE d.CalendarYear BETWEEN 2010 AND 2013\n    GROUP BY pc.EnglishProductCategoryName\n)\nSELECT\n    COALESCE(i.EnglishProductCategoryName, r.EnglishProductCategoryName) AS EnglishProductCategoryName,\n    i.InternetSalesAmount,\n    r.ResellerSalesAmount\nFROM InternetSales AS i\nFULL OUTER JOIN ResellerSales AS r\n    ON i.EnglishProductCategoryName = r.EnglishProductCategoryName\nORDER BY EnglishProductCategoryName;",
    "model_sql": "WITH SalesByProductCategoryAndYear AS ( SELECT d.CalendarYear, pc.EnglishProductCategoryName, SUM(CASE WHEN fis.SalesAmount IS NOT NULL THEN fis.SalesAmount ELSE 0 END) AS InternetSalesAmount, SUM(CASE WHEN frs.SalesAmount IS NOT NULL THEN frs.SalesAmount ELSE 0 END) AS ResellerSalesAmount FROM DimDate d LEFT JOIN FactInternetSales fis ON d.DateKey = fis.OrderDateKey LEFT JOIN FactResellerSales frs ON d.DateKey = frs.OrderDateKey JOIN DimProduct p ON fis.ProductKey = p.ProductKey OR frs.ProductKey = p.ProductKey JOIN DimProductSubcategory psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey JOIN DimProductCategory pc ON psc.ProductCategoryKey = pc.ProductCategoryKey WHERE d.CalendarYear BETWEEN 2010 AND 2013 GROUP BY d.CalendarYear, pc.EnglishProductCategoryName ) SELECT CalendarYear, EnglishProductCategoryName, InternetSalesAmount, ResellerSalesAmount FROM SalesByProductCategoryAndYear ORDER BY CalendarYear, EnglishProductCategoryName",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 2,
    "repaired": true,
    "gold_row_count": 4,
    "model_row_count": 16,
    "sql_exact_match": false,
    "model_correct": false
  },
  {
    "id": 39,
    "question": "Average inventory UnitsBalance by product and Product Category between 2010 and 2014",
    "gold_sql": "SELECT\n    pc.EnglishProductCategoryName,\n    psc.EnglishProductSubcategoryName,\n    p.ProductKey,\n    p.EnglishProductName,\n    AVG(CAST(fpi.UnitsBalance AS float)) AS AvgUnitsBalance\nFROM FactProductInventory AS fpi\nJOIN DimProduct AS p ON fpi.ProductKey = p.ProductKey\nJOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey\nJOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey\nJOIN DimDate AS d ON fpi.DateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY pc.EnglishProductCategoryName, psc.EnglishProductSubcategoryName, p.ProductKey, p.EnglishProductName\nORDER BY pc.EnglishProductCategoryName, psc.EnglishProductSubcategoryName, AvgUnitsBalance DESC;",
    "model_sql": "WITH InventoryData AS ( SELECT p.ProductKey, pc.EnglishProductCategoryName, fi.UnitsBalance FROM FactProductInventory AS fi JOIN DimProduct AS p ON fi.ProductKey = p.ProductKey JOIN DimProductSubcategory AS psc ON p.ProductSubcategoryKey = psc.ProductSubcategoryKey JOIN DimProductCategory AS pc ON psc.ProductCategoryKey = pc.ProductCategoryKey JOIN DimDate AS d ON fi.DateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 ) SELECT ProductKey, EnglishProductCategoryName, AVG(UnitsBalance) AS AvgUnitsBalance FROM InventoryData GROUP BY ProductKey, EnglishProductCategoryName ORDER BY EnglishProductCategoryName, ProductKey",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 397,
    "model_row_count": 397,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 40,
    "question": "Internet Sales Amount by Product Line between 2010 and 2014",
    "gold_sql": "SELECT\n    p.ProductLine,\n    SUM(fis.SalesAmount) AS TotalSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY p.ProductLine\nORDER BY TotalSalesAmount DESC;",
    "model_sql": "SELECT p.ProductLine, d.CalendarYear, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.ProductLine, d.CalendarYear ORDER BY p.ProductLine, d.CalendarYear",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 4,
    "model_row_count": 16,
    "sql_exact_match": false,
    "model_correct": false
  },
  {
    "id": 41,
    "question": "Internet Sales Amount by product Color between 2010 and 2014",
    "gold_sql": "SELECT\n    COALESCE(p.Color, 'Unknown') AS Color,\n    SUM(fis.SalesAmount) AS TotalSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY COALESCE(p.Color, 'Unknown')\nORDER BY TotalSalesAmount DESC;",
    "model_sql": "SELECT p.Color, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.Color ORDER BY TotalSalesAmount DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": true,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 8,
    "model_row_count": 8,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 42,
    "question": "Internet Sales Amount by product Class and Style between 2010 and 2014",
    "gold_sql": "SELECT\n    p.Class,\n    p.Style,\n    SUM(fis.SalesAmount) AS TotalSalesAmount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY p.Class, p.Style\nORDER BY TotalSalesAmount DESC;",
    "model_sql": "SELECT p.Class, p.Style, SUM(fis.SalesAmount) AS TotalSalesAmount FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.Class, p.Style ORDER BY TotalSalesAmount DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": true,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 10,
    "model_row_count": 10,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 43,
    "question": "Top 10 products by number of distinct Internet customers between 2010 and 2014",
    "gold_sql": "SELECT TOP 10\n    p.ProductKey,\n    p.EnglishProductName,\n    COUNT(DISTINCT fis.CustomerKey) AS DistinctCustomerCount\nFROM FactInternetSales AS fis\nJOIN DimProduct AS p ON fis.ProductKey = p.ProductKey\nJOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2014\nGROUP BY p.ProductKey, p.EnglishProductName\nORDER BY DistinctCustomerCount DESC;",
    "model_sql": "SELECT TOP 10 p.ProductKey, p.EnglishProductName, COUNT(DISTINCT fis.CustomerKey) AS NumberOfDistinctCustomers FROM FactInternetSales AS fis JOIN DimProduct AS p ON fis.ProductKey = p.ProductKey JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 GROUP BY p.ProductKey, p.EnglishProductName ORDER BY NumberOfDistinctCustomers DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": true,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 10,
    "model_row_count": 10,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 44,
    "question": "Top 10 products by number of distinct resellers between 2010 and 2013",
    "gold_sql": "SELECT TOP 10\n    p.ProductKey,\n    p.EnglishProductName,\n    COUNT(DISTINCT frs.ResellerKey) AS DistinctResellerCount\nFROM FactResellerSales AS frs\nJOIN DimProduct AS p ON frs.ProductKey = p.ProductKey\nJOIN DimDate AS d ON frs.OrderDateKey = d.DateKey\nWHERE d.CalendarYear BETWEEN 2010 AND 2013\nGROUP BY p.ProductKey, p.EnglishProductName\nORDER BY DistinctResellerCount DESC;",
    "model_sql": "SELECT TOP 10 p.ProductKey, p.EnglishProductName, COUNT(DISTINCT frs.ResellerKey) AS DistinctResellers FROM FactResellerSales AS frs JOIN DimProduct AS p ON frs.ProductKey = p.ProductKey JOIN DimDate AS d ON frs.OrderDateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2013 GROUP BY p.ProductKey, p.EnglishProductName ORDER BY DistinctResellers DESC",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 10,
    "model_row_count": 10,
    "sql_exact_match": false,
    "model_correct": true
  },
  {
    "id": 45,
    "question": "Internet product penetration: share of products with at least one Internet Sale between 2010 and 2014",
    "gold_sql": "WITH ProductsSoldInternet AS (\n    SELECT DISTINCT\n        fis.ProductKey\n    FROM FactInternetSales AS fis\n    JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey\n    WHERE d.CalendarYear BETWEEN 2010 AND 2014\n)\nSELECT\n    COUNT(*) AS TotalProducts,\n    COUNT(psi.ProductKey) AS ProductsWithInternetSales,\n    CAST(COUNT(psi.ProductKey) AS float) / NULLIF(COUNT(*), 0) AS InternetProductPenetration\nFROM DimProduct AS p\nLEFT JOIN ProductsSoldInternet AS psi\n    ON p.ProductKey = psi.ProductKey;",
    "model_sql": "WITH ProductsWithSales AS ( SELECT DISTINCT fis.ProductKey FROM FactInternetSales AS fis JOIN DimDate AS d ON fis.OrderDateKey = d.DateKey WHERE d.CalendarYear BETWEEN 2010 AND 2014 ) SELECT CAST(COUNT(DISTINCT pwp.ProductKey) AS FLOAT) / COUNT(DISTINCT p.ProductKey) * 100 AS InternetProductPenetration FROM ProductsWithSales AS pwp JOIN DimProduct AS p ON pwp.ProductKey = p.ProductKey",
    "validated": true,
    "model_exec_ok": true,
    "result_match": false,
    "gold_error": null,
    "model_error": null,
    "diagnostics": {
      "is_safe": true,
      "unknown_tables": [],
      "unknown_columns": [],
      "bad_year_usage": null,
      "preflight_ok": true,
      "preflight_error": "ok"
    },
    "attempts": 1,
    "repaired": false,
    "gold_row_count": 1,
    "model_row_count": 1,
    "sql_exact_match": false,
    "model_correct": true
  }
]